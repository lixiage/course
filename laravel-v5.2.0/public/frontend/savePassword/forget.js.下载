define(function(require){function a(a){var g=/^[\u4E00-\u9FA5\uf900-\ufa2d\w]{1,24}$/,c=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,_=$(".msg_wrong").find("div");if($("#pageRegister").html()){{$(".inpt_regPas").val()}_getName=g.test($(".inpt_regName").val()),_getMail=c.test($(".inpt_regMail").val()),_getPass=$(".inpt_regPas").val().length>5,_ckSp=$(".inpt_regPas").val().indexOf(" ")>=0}switch(a){case"checkMail":""==$(".inpt_regMail").val()?$(".reg_mail_th").html('<span class="reg_wrong">请输入邮箱</span>'):$.ajax({type:"post",url:"/user/ajaxcheckemail",data:"email="+$(".inpt_regMail").val(),dataType:"json",success:function(a){$(".reg_mail_th").html(1==a.status?'<span class="reg_right"></span>':'<span class="reg_wrong">'+a.msg+"</span>")}});break;case"checkPass":$(".reg_pass_th").html(_getPass?_ckSp?'<span class="reg_atn">密码不能有空格</span>':'<span class="reg_right"></span>':'<span class="reg_atn">密码不能少于6位</span>');break;case"checkRegedMail":c.test($(".inpt_regedMail").val())?_.hide():""==$(".inpt_regedMail").val()?(_.html("请输入邮箱"),_.show()):(_.html("邮箱格式错误"),_.show());break;case"checkRstPw":var h=$(".inpt_rstPw").val(),w=$(".inpt_rstPw_c").val();h.length<6?(_.html("密码不能少于6位"),_.show()):h.length>16?(_.html("密码不能大于16位"),_.show()):h.indexOf(" ")>=0?(_.html("密码不能含有空格"),_.show()):(_.hide(),h!=w?""!=w&&(_.html("密码输入不一致"),_.show()):(_.hide(),$("#pagePwReset").submit()))}$("#pageRegister").html()&&$(".reg_name_th").html(_getName?'<span class="reg_right"></span>':'<span class="reg_wrong">中英数字下划线1-24字</span>')}function g(){var a=$(".msg_wrong").find("div"),g=$(".inpt_code").parent("div");$.ajax({type:"POST",url:"/user/getpasswd",dataType:"json",data:"email="+$(".inpt_regedMail").val()+"&verifycode="+$(".inpt_code").val(),success:function(c){1===c.status&&(window.location="/user/sendresult"),0===c.status&&(a.html(c.msg),a.show()),2===c.status&&(a.html(""==$(".inpt_regedMail").val()?"请输入邮箱":c.msg),a.show()),3===c.status&&g.addClass("code_ipt_w"),4===c.status&&(a.html(c.msg),a.show())},error:function(){alert("请求无响应！")}})}require("common"),$(document).delegate(".inpt_regedMail","blur",function(){a("checkRegedMail")});var c=$(".code_img").find("img");c.attr("src","/user/getcode?t="+(new Date).getTime()),$(document).delegate(".code_img","click",function(){c.removeAttr("src"),c.attr("src","/user/getcode?t="+(new Date).getTime())}),$(document).delegate(".cngImg","click",function(){c.removeAttr("src"),c.attr("src","/user/getcode?t="+(new Date).getTime())}),$(document).delegate(".loginbox_getPas","click",function(){g()}),$(window).keydown(function(a){13==a.keyCode&&g()})});